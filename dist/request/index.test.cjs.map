{"version":3,"sources":["../../src/request/index.test.ts"],"sourcesContent":["import { verifyRequestOrigin } from \"./index.js\";\nimport { describe, test, expect } from \"vitest\";\n\ndescribe(\"verifyRequestOrigin()\", () => {\n\ttest(\"checks if origin and host matches\", () => {\n\t\texpect(verifyRequestOrigin(\"https://example.com\", [\"example.com\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.co.jp\", [\"example.co.jp\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.com\", [\"invalid.com\"])).toBe(false);\n\t});\n\n\ttest(\"allows full urls for host\", () => {\n\t\texpect(verifyRequestOrigin(\"https://example.com\", [\"https://example.com\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.co.jp\", [\"https://example.co.jp\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.com\", [\"https://invalid.com\"])).toBe(false);\n\t});\n\n\ttest(\"checks port\", () => {\n\t\texpect(verifyRequestOrigin(\"https://example.com:1000\", [\"example.com:1000\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.com:1000\", [\"example.com:2000\"])).toBe(false);\n\t});\n\n\ttest(\"IDN\", () => {\n\t\texpect(verifyRequestOrigin(\"http://xn--zckzah.com\", [\"xn--zckzah.com\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"http://xn--zckzah.com\", [\"テスト.com\"])).toBe(true);\n\t});\n});\n"],"mappings":";AAAA,mBAAoC;AACpC,oBAAuC;AAAA,IAEvC,wBAAS,yBAAyB,MAAM;AACvC,0BAAK,qCAAqC,MAAM;AAC/C,kCAAO,kCAAoB,uBAAuB,CAAC,aAAa,CAAC,CAAC,EAAE,KAAK,IAAI;AAC7E,kCAAO,kCAAoB,yBAAyB,CAAC,eAAe,CAAC,CAAC,EAAE,KAAK,IAAI;AACjF,kCAAO,kCAAoB,uBAAuB,CAAC,aAAa,CAAC,CAAC,EAAE,KAAK,KAAK;AAAA,EAC/E,CAAC;AAED,0BAAK,6BAA6B,MAAM;AACvC,kCAAO,kCAAoB,uBAAuB,CAAC,qBAAqB,CAAC,CAAC,EAAE,KAAK,IAAI;AACrF,kCAAO,kCAAoB,yBAAyB,CAAC,uBAAuB,CAAC,CAAC,EAAE,KAAK,IAAI;AACzF,kCAAO,kCAAoB,uBAAuB,CAAC,qBAAqB,CAAC,CAAC,EAAE,KAAK,KAAK;AAAA,EACvF,CAAC;AAED,0BAAK,eAAe,MAAM;AACzB,kCAAO,kCAAoB,4BAA4B,CAAC,kBAAkB,CAAC,CAAC,EAAE,KAAK,IAAI;AACvF,kCAAO,kCAAoB,4BAA4B,CAAC,kBAAkB,CAAC,CAAC,EAAE,KAAK,KAAK;AAAA,EACzF,CAAC;AAED,0BAAK,OAAO,MAAM;AACjB,kCAAO,kCAAoB,yBAAyB,CAAC,gBAAgB,CAAC,CAAC,EAAE,KAAK,IAAI;AAClF,kCAAO,kCAAoB,yBAAyB,CAAC,wBAAS,CAAC,CAAC,EAAE,KAAK,IAAI;AAAA,EAC5E,CAAC;AACF,CAAC;","names":[]}