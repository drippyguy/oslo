{"version":3,"sources":["../../src/request/index.test.ts"],"sourcesContent":["import { verifyRequestOrigin } from \"./index.js\";\nimport { describe, test, expect } from \"vitest\";\n\ndescribe(\"verifyRequestOrigin()\", () => {\n\ttest(\"checks if origin and host matches\", () => {\n\t\texpect(verifyRequestOrigin(\"https://example.com\", [\"example.com\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.co.jp\", [\"example.co.jp\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.com\", [\"invalid.com\"])).toBe(false);\n\t});\n\n\ttest(\"allows full urls for host\", () => {\n\t\texpect(verifyRequestOrigin(\"https://example.com\", [\"https://example.com\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.co.jp\", [\"https://example.co.jp\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.com\", [\"https://invalid.com\"])).toBe(false);\n\t});\n\n\ttest(\"checks port\", () => {\n\t\texpect(verifyRequestOrigin(\"https://example.com:1000\", [\"example.com:1000\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"https://example.com:1000\", [\"example.com:2000\"])).toBe(false);\n\t});\n\n\ttest(\"IDN\", () => {\n\t\texpect(verifyRequestOrigin(\"http://xn--zckzah.com\", [\"xn--zckzah.com\"])).toBe(true);\n\t\texpect(verifyRequestOrigin(\"http://xn--zckzah.com\", [\"テスト.com\"])).toBe(true);\n\t});\n});\n"],"mappings":"AAAA,SAAS,2BAA2B;AACpC,SAAS,UAAU,MAAM,cAAc;AAEvC,SAAS,yBAAyB,MAAM;AACvC,OAAK,qCAAqC,MAAM;AAC/C,WAAO,oBAAoB,uBAAuB,CAAC,aAAa,CAAC,CAAC,EAAE,KAAK,IAAI;AAC7E,WAAO,oBAAoB,yBAAyB,CAAC,eAAe,CAAC,CAAC,EAAE,KAAK,IAAI;AACjF,WAAO,oBAAoB,uBAAuB,CAAC,aAAa,CAAC,CAAC,EAAE,KAAK,KAAK;AAAA,EAC/E,CAAC;AAED,OAAK,6BAA6B,MAAM;AACvC,WAAO,oBAAoB,uBAAuB,CAAC,qBAAqB,CAAC,CAAC,EAAE,KAAK,IAAI;AACrF,WAAO,oBAAoB,yBAAyB,CAAC,uBAAuB,CAAC,CAAC,EAAE,KAAK,IAAI;AACzF,WAAO,oBAAoB,uBAAuB,CAAC,qBAAqB,CAAC,CAAC,EAAE,KAAK,KAAK;AAAA,EACvF,CAAC;AAED,OAAK,eAAe,MAAM;AACzB,WAAO,oBAAoB,4BAA4B,CAAC,kBAAkB,CAAC,CAAC,EAAE,KAAK,IAAI;AACvF,WAAO,oBAAoB,4BAA4B,CAAC,kBAAkB,CAAC,CAAC,EAAE,KAAK,KAAK;AAAA,EACzF,CAAC;AAED,OAAK,OAAO,MAAM;AACjB,WAAO,oBAAoB,yBAAyB,CAAC,gBAAgB,CAAC,CAAC,EAAE,KAAK,IAAI;AAClF,WAAO,oBAAoB,yBAAyB,CAAC,wBAAS,CAAC,CAAC,EAAE,KAAK,IAAI;AAAA,EAC5E,CAAC;AACF,CAAC;","names":[]}