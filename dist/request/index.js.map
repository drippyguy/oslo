{"version":3,"sources":["../../src/request/index.ts"],"sourcesContent":["export function verifyRequestOrigin(origin: string, allowedDomains: string[]): boolean {\n\tif (!origin || allowedDomains.length === 0) return false;\n\tconst originHost = safeURL(origin)?.host ?? null;\n\tif (!originHost) return false;\n\tfor (const domain of allowedDomains) {\n\t\tlet host: string | null;\n\t\tif (domain.startsWith(\"http://\") || domain.startsWith(\"https://\")) {\n\t\t\thost = safeURL(domain)?.host ?? null;\n\t\t} else {\n\t\t\thost = safeURL(\"https://\" + domain)?.host ?? null;\n\t\t}\n\t\tif (originHost === host) return true;\n\t}\n\treturn false;\n}\n\nfunction safeURL(url: URL | string): URL | null {\n\ttry {\n\t\treturn new URL(url);\n\t} catch {\n\t\treturn null;\n\t}\n}\n"],"mappings":"AAAO,SAAS,oBAAoB,QAAgB,gBAAmC;AACtF,MAAI,CAAC,UAAU,eAAe,WAAW;AAAG,WAAO;AACnD,QAAM,aAAa,QAAQ,MAAM,GAAG,QAAQ;AAC5C,MAAI,CAAC;AAAY,WAAO;AACxB,aAAW,UAAU,gBAAgB;AACpC,QAAI;AACJ,QAAI,OAAO,WAAW,SAAS,KAAK,OAAO,WAAW,UAAU,GAAG;AAClE,aAAO,QAAQ,MAAM,GAAG,QAAQ;AAAA,IACjC,OAAO;AACN,aAAO,QAAQ,aAAa,MAAM,GAAG,QAAQ;AAAA,IAC9C;AACA,QAAI,eAAe;AAAM,aAAO;AAAA,EACjC;AACA,SAAO;AACR;AAEA,SAAS,QAAQ,KAA+B;AAC/C,MAAI;AACH,WAAO,IAAI,IAAI,GAAG;AAAA,EACnB,QAAQ;AACP,WAAO;AAAA,EACR;AACD;","names":[]}