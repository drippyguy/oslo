{"version":3,"sources":["../../src/otp/uri.ts"],"sourcesContent":["import { base32 } from \"../encoding/index.js\";\n\nimport type { TimeSpan, TypedArray } from \"../index.js\";\n\nexport function createTOTPKeyURI(\n\tissuer: string,\n\taccountName: string,\n\tsecret: ArrayBuffer | TypedArray,\n\toptions?: {\n\t\tdigits?: number;\n\t\tperiod?: TimeSpan;\n\t}\n): string {\n\tconst [baseURI, params] = createKeyURIBase(\"totp\", issuer, accountName, secret, options);\n\tif (options?.period !== undefined) {\n\t\tparams.set(\"period\", options.period.seconds().toString());\n\t}\n\treturn baseURI + \"?\" + params.toString();\n}\n\nexport function createHOTPKeyURI(\n\tissuer: string,\n\taccountName: string,\n\tsecret: ArrayBuffer | TypedArray,\n\toptions?: {\n\t\tcounter?: number;\n\t\tdigits?: number;\n\t}\n): string {\n\tconst [baseURI, params] = createKeyURIBase(\"hotp\", issuer, accountName, secret, options);\n\tconst counter = options?.counter ?? 0;\n\tparams.set(\"counter\", counter.toString());\n\treturn baseURI + \"?\" + params.toString();\n}\n\nfunction createKeyURIBase(\n\ttype: \"totp\" | \"hotp\",\n\tissuer: string,\n\taccountName: string,\n\tsecret: ArrayBuffer | TypedArray,\n\toptions?: {\n\t\tdigits?: number;\n\t}\n): [baseURI: string, params: URLSearchParams] {\n\tconst encodedIssuer = encodeURIComponent(issuer);\n\tconst encodedAccountName = encodeURIComponent(accountName);\n\tconst baseURI = `otpauth://${type}/${encodedIssuer}:${encodedAccountName}`;\n\tconst params = new URLSearchParams({\n\t\tsecret: base32.encode(new Uint8Array(secret), {\n\t\t\tincludePadding: false\n\t\t}),\n\t\tissuer: encodedIssuer\n\t});\n\tif (options?.digits !== undefined) {\n\t\tparams.set(\"digits\", options.digits.toString());\n\t}\n\treturn [baseURI, params];\n}\n"],"mappings":"AAAA,SAAS,cAAc;AAIhB,SAAS,iBACf,QACA,aACA,QACA,SAIS;AACT,QAAM,CAAC,SAAS,MAAM,IAAI,iBAAiB,QAAQ,QAAQ,aAAa,QAAQ,OAAO;AACvF,MAAI,SAAS,WAAW,QAAW;AAClC,WAAO,IAAI,UAAU,QAAQ,OAAO,QAAQ,EAAE,SAAS,CAAC;AAAA,EACzD;AACA,SAAO,UAAU,MAAM,OAAO,SAAS;AACxC;AAEO,SAAS,iBACf,QACA,aACA,QACA,SAIS;AACT,QAAM,CAAC,SAAS,MAAM,IAAI,iBAAiB,QAAQ,QAAQ,aAAa,QAAQ,OAAO;AACvF,QAAM,UAAU,SAAS,WAAW;AACpC,SAAO,IAAI,WAAW,QAAQ,SAAS,CAAC;AACxC,SAAO,UAAU,MAAM,OAAO,SAAS;AACxC;AAEA,SAAS,iBACR,MACA,QACA,aACA,QACA,SAG6C;AAC7C,QAAM,gBAAgB,mBAAmB,MAAM;AAC/C,QAAM,qBAAqB,mBAAmB,WAAW;AACzD,QAAM,UAAU,aAAa,IAAI,IAAI,aAAa,IAAI,kBAAkB;AACxE,QAAM,SAAS,IAAI,gBAAgB;AAAA,IAClC,QAAQ,OAAO,OAAO,IAAI,WAAW,MAAM,GAAG;AAAA,MAC7C,gBAAgB;AAAA,IACjB,CAAC;AAAA,IACD,QAAQ;AAAA,EACT,CAAC;AACD,MAAI,SAAS,WAAW,QAAW;AAClC,WAAO,IAAI,UAAU,QAAQ,OAAO,SAAS,CAAC;AAAA,EAC/C;AACA,SAAO,CAAC,SAAS,MAAM;AACxB;","names":[]}