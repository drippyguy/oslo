{"version":3,"sources":["../../src/crypto/hmac.ts"],"sourcesContent":["import type { TypedArray } from \"../index.js\";\nimport type { SHAHash } from \"./sha.js\";\n\nexport class HMAC {\n\tprivate hash: SHAHash;\n\tconstructor(hash: SHAHash) {\n\t\tthis.hash = hash;\n\t}\n\n\tpublic async verify(\n\t\tkey: ArrayBuffer | TypedArray,\n\t\tsignature: ArrayBuffer | TypedArray,\n\t\tdata: ArrayBuffer | TypedArray\n\t): Promise<boolean> {\n\t\tconst cryptoKey = await crypto.subtle.importKey(\n\t\t\t\"raw\",\n\t\t\tkey,\n\t\t\t{\n\t\t\t\tname: \"HMAC\",\n\t\t\t\thash: this.hash\n\t\t\t},\n\t\t\tfalse,\n\t\t\t[\"verify\"]\n\t\t);\n\t\treturn await crypto.subtle.verify(\"HMAC\", cryptoKey, signature, data);\n\t}\n\n\tpublic async sign(\n\t\tkey: ArrayBuffer | TypedArray,\n\t\tdata: ArrayBuffer | TypedArray\n\t): Promise<ArrayBuffer> {\n\t\tconst cryptoKey = await crypto.subtle.importKey(\n\t\t\t\"raw\",\n\t\t\tkey,\n\t\t\t{\n\t\t\t\tname: \"HMAC\",\n\t\t\t\thash: this.hash\n\t\t\t},\n\t\t\tfalse,\n\t\t\t[\"sign\"]\n\t\t);\n\t\tconst signature = await crypto.subtle.sign(\"HMAC\", cryptoKey, data);\n\t\treturn signature;\n\t}\n\n\tpublic async generateKey(): Promise<ArrayBuffer> {\n\t\tconst cryptoKey: CryptoKey = await crypto.subtle.generateKey(\n\t\t\t{\n\t\t\t\tname: \"HMAC\",\n\t\t\t\thash: this.hash\n\t\t\t},\n\t\t\ttrue,\n\t\t\t[\"sign\"]\n\t\t);\n\t\tconst key = await crypto.subtle.exportKey(\"raw\", cryptoKey);\n\t\treturn key;\n\t}\n}\n"],"mappings":"AAGO,MAAM,KAAK;AAAA,EACT;AAAA,EACR,YAAY,MAAe;AAC1B,SAAK,OAAO;AAAA,EACb;AAAA,EAEA,MAAa,OACZ,KACA,WACA,MACmB;AACnB,UAAM,YAAY,MAAM,OAAO,OAAO;AAAA,MACrC;AAAA,MACA;AAAA,MACA;AAAA,QACC,MAAM;AAAA,QACN,MAAM,KAAK;AAAA,MACZ;AAAA,MACA;AAAA,MACA,CAAC,QAAQ;AAAA,IACV;AACA,WAAO,MAAM,OAAO,OAAO,OAAO,QAAQ,WAAW,WAAW,IAAI;AAAA,EACrE;AAAA,EAEA,MAAa,KACZ,KACA,MACuB;AACvB,UAAM,YAAY,MAAM,OAAO,OAAO;AAAA,MACrC;AAAA,MACA;AAAA,MACA;AAAA,QACC,MAAM;AAAA,QACN,MAAM,KAAK;AAAA,MACZ;AAAA,MACA;AAAA,MACA,CAAC,MAAM;AAAA,IACR;AACA,UAAM,YAAY,MAAM,OAAO,OAAO,KAAK,QAAQ,WAAW,IAAI;AAClE,WAAO;AAAA,EACR;AAAA,EAEA,MAAa,cAAoC;AAChD,UAAM,YAAuB,MAAM,OAAO,OAAO;AAAA,MAChD;AAAA,QACC,MAAM;AAAA,QACN,MAAM,KAAK;AAAA,MACZ;AAAA,MACA;AAAA,MACA,CAAC,MAAM;AAAA,IACR;AACA,UAAM,MAAM,MAAM,OAAO,OAAO,UAAU,OAAO,SAAS;AAC1D,WAAO;AAAA,EACR;AACD;","names":[]}